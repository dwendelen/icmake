<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<title>icmbuild</title>
<style type="text/css">
    figure {text-align: center;}
    img {vertical-align: center;}
</style>
<link rev="made" href="mailto:Frank B. Brokken: f.b.brokken@rug.nl">
</head>
<body text="#27408B" bgcolor="#FFFAF0">
<hr/>
<h1 id="title">icmbuild</h1>
<h2 id="author">icmake.9.01.00.tar.gz</h2>
<h2 id="date">1992-2016</h2>

<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<style type="text/css">
    figure {text-align: center;}
    img {vertical-align: center;}
    figure {text-align: center;}
    img {vertical-align: center;}
</style>
<link rev="made" href="mailto:Frank B. Brokken: f.b.brokken@rug.nl">
</head>
<body text="#27408B" bgcolor="#FFFAF0">
<hr/>
<h1 id="title"></h1>

<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<title>icmbuild(1)</title>
<style type="text/css">
    figure {text-align: center;}
    img {vertical-align: center;}
    figure {text-align: center;}
    img {vertical-align: center;}
    figure {text-align: center;}
    img {vertical-align: center;}
</style>
<link rev="made" href="mailto:Frank B. Brokken: f.b.brokken@rug.nl">
</head>
<body text="#27408B" bgcolor="#FFFAF0">
<hr/>
<h1 id="title">icmbuild(1)</h1>
<h2 id="author">icmake.9.01.00.tar.gz A generic program maintenance script</h2>
<h2 id="date">1992-2016</h2>


<p>

<h2 >NAME</h2>icmbuild - A generic, easy configurable, program maintenance script
<p>

<h2 >SYNOPSIS</h2>
       <strong >icmbuild</strong> [-h] [-c] <em >args</em>
<p>
<h2 >DESCRIPTION</h2>
<p>
The <strong >icmbuild</strong> script is a generic script that can be used to do program
maintenance using <strong >icmake</strong>(1). 
<p>
<strong >Icmbuild</strong> requires that the  file <em >icmconf</em> is available in the directory where
program maintenance is requested.
<p>
<strong >Icmbuild</strong> assumes that your sources exist in and below the current working
directory. The file <em >icmconf</em> in <strong >icmake</strong>(1)'s distribution provides an
example of an <em >icmconf</em> file that can be used by <strong >icmbuild</strong>. In that example
<em >icmconf</em> file it is assumed that <strong >C++</strong> sources are maintained, but
program maintenance for, e.g., <strong >C</strong> sources can easily be configured.
<p>
<strong >Icmbuild</strong>() compiles all sources in each of the subdirectories named in the file
<em >CLASSES</em>, and then compiles all sources in the current working directory.
<p>
The compiled sources result in object modules which may be kept in a
library, against which the main-object module is linked. It is also possible
to specify additional libraries against which the program must be linked.
<p>
If a library is constructed it is kept up to date by <strong >icmbuild</strong>. When a source is
successfully compiled its new object module replaces the old one that is found
in the library. At that point the object files are no longer required and are
removed by <strong >icmbuild</strong>.
<p>
<h2 >KICK-STARTING ICMBUILD</h2>
<p>
To use <strong >icmbuild</strong> do as follows:
    <ul>
    <li>  Install <strong >icmbuild</strong> in your path;
    <li> copy <em >icmconf</em> (and probably the file <em >CLASSES</em>) to your
       project's base directory (i.e., the directory in which and where below
       the project's sources are found);
    <li> Modify the <em >#defines</em> in the file <em >icmconf</em> to taste;
    <li> Enter the names of subdirectories containing sources on separate
       lines in the file <em >CLASSES</em>
<p>
Note that the order of the classes mentioned in <em >CLASSES</em> <em >is</em>
       relevant.  New class (subdirectory) names can always be added, but
       reordering the lines in the <em >CLASSES</em> file should be avoided. If
       reordering is necessary, then first run the command <em >icmbuild clean</em>
       to remove all files thus far created by <strong >icmbuild</strong>. Recompilation is
       necessary as the names of the object files contain class order-numbers
       for identification.  These class-order numbers prevent file-name
       collisions (e.g., two classes might use a file <em >data.cc</em>) and thus
       replacement of a file <em >x.o</em> from class <em >A</em> by file <em >x.o</em> from
       class <em >B</em> is prevented;
    <li> Now (after configuring <em >icmconf</em>) simply run 
        <pre>

            icmbuild -h
        
</pre>

       from the project's base directory and let the help-info tell you
       what your options are. See the next section for the modes of operation.
    </ul>
<p>
<h2 >OPTIONS</h2>
<p>
<strong >Icmbuild</strong> recognizes two options, at most one should be specified:
    <ul>
    <li><em >-h</em>: Provide a short usage overview.
    <li><em >-c</em>: Clear the screen (using <em >tput clear</em>) before starting the
       compilation process
    </ul>
<p>
Following the optional <em >-c</em>  <strong >icmbuild</strong>() the following arguments may be
       passed to <strong >icmbuild</strong>:
    <ul>
    <li><em >clean</em><br/>
        clean up remnants of previous activities
    <li><em >library</em><br/>
        build the library (static and optionally the dynamic library)
    <li><em >program</em><br/>
        build the binary program
    <li><em >program strip</em><br/>
        build the stripped binary program
    <li><em >install program path</em>
        install the constructed program in the specified path (to be used
       after issuing <strong >icmbuild</strong> <em >program</em>)
    <li><em >install static path</em> 
       install the constructed static library in the specified path (to be
        used after issuing <strong >icmbuild</strong> <em >library</em>)
    <li><em >install shared path</em> 
       install the constructed shared library in the specified path (to be
        used after issuing <strong >icmbuild</strong> <em >library</em>)
    </ul>
    After adding a line to <em >icmconf</em> containing
        <pre>

    #define DEFCOM "program"
        
</pre>

    <strong >icmbuild</strong> by default uses the argument <em >program</em>. After adding 
        <pre>

    #define DEFCOM "strip"
        
</pre>

    <strong >icmbuild</strong> by default uses the argument <em >strip</em>. After adding 
        <pre>

    #define DEFCOM "library"
        
</pre>

    <strong >icmbuild</strong> by default uses the argument <em >library</em>.
<p>
<em >DEFCOM</em> is ignored when an explicit operational mode is passed to
        <strong >icmbuild</strong>.
<p>
<h2 >ICM-DEP</h2>
<p>
Class dependencies are handled by <em >icmake</em>'s support program
<em >icm-dep</em>. It can be called from <em >icmake</em> by passing it the option
<em >-d</em>. All options and arguments following <em >-d</em> are forwared to
<em >icm-dep</em>.
<p>
The program <em >icm-dep</em> is automatically called by <em >icmbuild</em> to handle
class dependencies. Consider two classes <em >Options</em> and <em >Process</em>. If
<em >Process</em> uses <em >Options</em> and if precompiled header files are used, then in
addition to <em >Option's</em> header file, <em >Process's</em> header must also be
precompiled if <em >Option's</em> header file changes. Likewise, if <em >Option's</em>
data organization is changed and <em >Option</em> defines inline members used by
<em >Process</em> or <em >Process</em> defines an <em >Option</em> data member then, in addition
to <em >Option's</em> sources sources <em >Process's</em> sources must also be
compiled. For the latter case <em >icmconf</em> uses the <em >USE_ALL</em> specification:
if a <em >`USE_ALL'</em> file exists in a directory, then all sources of that
directory are recompiled. 
<p>
The program <em >icm_dep</em> determines all such class dependencies, and will
recompile class header files of all classes depending on classes whose header
files must be recompiled. Furthermore, if a <em >`USE_ALL'</em> file exists in a
directory then all sources of classes depending on that directory's class are
also recompiled. 
<p>
<em >Icm-dep's</em> options are described in <strong >icmake</strong>(1)'s man-page.
<p>
To start its work, <em >icm_dep</em> needs one command-line argument:
<em >go</em>. Any other argument results in <em >icm_dep</em> performing a `dry run': it
will perform all its duties (and verbose messages are displayed as if <em >go</em>
had been specified), but no files (precompiled headers or <em >USE_ALL</em> files)
will be touched or removed. If neither options nor arguments are specified
<em >icm_dep</em> writes its usage summary to the standard output.
<p>
By default <em >icmbuild</em> calls <em >icmake -d -V go</em>: <em >icm_dep</em> is called to
perform its duties and to show its actions on the standard output stream. By
specifying a <em >#define ICM_DEP</em> parameter in the <em >icmconf</em> file this
default can be overruled (cf. <strong >icmconf</strong>(7)).
<p>
<h2 >FILES</h2>
<p>
The mentioned paths are sugestive only and may be installation dependent:
    <ul>
    <li> <strong >/usr/share/icmake/icmconf</strong>
        Example of a <strong >icmbuild</strong> configuration file;
    <li> <strong >/usr/share/icmake/CLASSES</strong>
        Example of a <strong >icmbuild</strong> <em >CLASSES</em> file.
    </ul>
<p>
<h2 >EXAMPLES</h2>
<p>
Here is an example of the configuration file <em >icmconf</em> for a concrete
       program, using the library <em >libbobcat1</em> as an additional library:
<p>
<pre >
    // Inspect the following #defines. Change them to taste. If you don't
    // need a particular option, change its value into an empty string

    // For more information about this file: 'man 7 icmconf'

// MAINTENANCE RELATED DEFINES THAT ARE OFTEN ADAPTED:
// ===================================================

    // Uncomment to clear the screen starting the compilation
//#define CLS

    // Uncomment to construct a library. Optionally use another name (don't
    // use lib or an extension like .a)
//#define LIBRARY           "modules"

    // The source containing main():
#define MAIN                "main.cc"

    // The pattern locating sources in a directory:
#define SOURCES             "*.cc"

    //  The extension of object modules:
#define OBJ_EXT             ".o"

    // Uncomment to construct a shared library 
//#define SHARED

    // If the constructed shared library requires additional libraries then
    // specify these here. E.g., if a library /usr/lib/special/libspecial.so
    // is required then specify  "-L/usr/lib/special -lspecial" 
    // Predefined paths (e.g., /lib, /usr/lib) do not have to be specified
#define SHAREDREQ           ""

    // Directory to contain temporary results
#define TMP_DIR             "tmp"

    // Uncomment to use the ALL facility and a class dependency setup in the
    // CLASSES file. When a directory contains a file ALL (optionally rename
    // this filename by providing an alternative name) then all its sources
    // and all sources of all classes depending on it are also compiled.  
    // Class dependencies are indicated by the class name (as the first
    // word on a line) optionally followed by additional class names, which
    // are the classes directly depending on the line's first class name.
//#define USE_ALL           "a"

    // By default dependencies are determined by icm-dep (via icmake -d),
    // passing it the following options. If icm-dep should not be called,
    // activate ICM_DEP as an empty string. Alternatively specify your own
    // icm-dep options
//#define ICM_DEP           "-V go"

    // should commands be echoed (ON) or not (OFF) ?
#define USE_ECHO            ON

    //  Use the VERSION file
#define USE_VERSION

    // When DEFCOM "program" is specified './icmbuild' is shorthand for 
    // './icmbuild program'
    // When DEFCOM "library" is specified './icmbuild' is shorthand for 
    // './icmbuild library'
    // The icmstart script may add a DEFCOM specification to this file.
//#define DEFCOM "program"
//#define DEFCOM "library"

// COMPILATION AND LINKING RELATED DEFINES
// =======================================

    // The compiler to use. Define CC instead if a C compiler should be used.
#define CXX            "g++"
//#define CC            "gcc"

    // The compiler options to use. Define CFLAGS instead if a C compiler is
    // used. 
    // To suppress colored error messages add option -fdiagnostics-color=never
    // To add debug-code to object files add option  -g
#define CXXFLAGS        " --std=c++14 -Wall -O2"
//#define CFLAGS        " -Wall -g -O2"

    // The extension of internal header files. See PRECOMP below
#define IH              ".ih"

    // Uncomment to generate precompiled headers. When activated internal
    // header files are precompiled when they are more recent than their 
    // precompiled versions. PRECOMP requires IH
//#define PRECOMP "-x c++-header"

    // Uncomment to suppress warnings about non-existing IH files in 
    // class-directories. This option is only interpreted when PRECOMP has
    // also been defined
//#define NO_PRECOMP_WARNING

    // Uncomment to relink the binary, even when no sources were changed 
//#define REFRESH


    // Options passed to the linker:
#define LDFLAGS         ""


// LIBRARIES REQUIRED BY THE CONSTRUCTED PROGRAM OR LIBRARY:
// =========================================================

    // any additional libraries the program may need:
#define ADD_LIBRARIES       ""

    // additional paths (other than the standard paths) to locate additional
    // libraries (specify absolute paths or relative to TMP_DIR):
#define ADD_LIBRARY_PATHS   ""


// DEFINES RELATED TO USING A PARSER GENERATOR
// ===========================================

    // The subdirectory containing the parser's specification file
    // If this directive is REMOVED, then all parser-related #defines
    // can also be removed from icmconf.
#define PARSER_DIR          ""

    // What is the program generating a parser?
#define PARSGEN             "bisonc++"

    // Flags to pass to PARSGEN:
#define PARSFLAGS           "-V"

    // What is the top-level (or only) grammar specification file?
#define PARSSPEC            "grammar"

    // Optionally use patterns to specify additional grammar specification 
    // files. These files are (in)directly included by PARSSPEC. Specify
    // patterns relative to PARSER_DIR
//#define PARSFILES           ""

    // The source file generated by the parser generator
#define PARSOUT             "parse.cc"


// DEFINES RELATED TO USING A SCANNER GENERATOR
// ============================================

    // The subdirectory containing the scanner's specification file
    // If this directive is REMOVED, then all scanner-related #defines
    // can also be removed from icmconf.
#define SCANNER_DIR         ""  

    // What is the program generating the lexical scanner?
#define SCANGEN             "flexc++"

    // Flags to provide SCANGEN with:
#define SCANFLAGS           ""

    // Name of the lexical scanner specification file
#define SCANSPEC            "lexer"
    
    // Optionally use patterns to specify additional scanner specification 
    // files. These files are (in)directly included by SCANSPEC. Specify
    // patterns relative to SCANNER_DIR
//#define SCANFILES            ""

    // The source file generated by the lexical scanner
#define SCANOUT             "lex.cc"






</pre>

<p>
<h2 >SEE ALSO</h2>
    <strong >icmake</strong>(1), <strong >icmconf</strong>(7), <strong >icmstart</strong>(1), <strong >icmstart.rc</strong>(7)
<p>
<h2 >BUGS</h2>
    None reported
<p>
<h2 >COPYRIGHT</h2>
    This is free software, distributed under the terms of the 
    GNU General Public License (GPL).
<p>
<h2 >AUTHOR</h2>
    Frank B. Brokken (<strong >f.b.brokken@rug.nl</strong>).
<p>
